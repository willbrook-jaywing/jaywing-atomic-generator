//-------------------------------------------------------
//  Generator: App
//-------------------------------------------------------

var _generator = require('yeoman-generator');
var _chalk = require('chalk');

var _PromptHelper = require('../../lib/shared/PromptHelper');
var _Core = require('../../lib/app/Core');

//-------------------------
//  Private
//-------------------------

var _promptTypeObj = _PromptHelper.getListObj('Type', ['Components', '|', 'Exit']);
var _promptActionObj = _PromptHelper.getListObj('Action', ['Add Files', '|', 'Exit']);

//-------------------------
//  Yeoman Base Extension
//-------------------------

var baseExtension = {

  _promptType: function () {
    var promptObj = _promptTypeObj;
    return this.prompt(promptObj).then(function (answers) {
      switch(answers.type) {
        case 'Components':
          this.composeWith('jaywing-atomic:components');
          break;
        case 'Exit':
          break;
      }
    }.bind(this));
  },

  _promptAction: function () {
    var promptObj = _promptActionObj;
    return this.prompt(promptObj).then(function (answers) {
      if(answers.action == 'Add Files') _Core.add();
    }.bind(this));
  },

  _promptStart: function () {

    this._promptType();

  },

  initializing: function () {
    _Core.init(this);
  },

  prompting: function () {

    this.log(' -------------------\\/-------------------');
    this.log(' |         JAYWING ATOMIC GENERATOR     |');
    this.log(' -------------------/\\-------------------');

    if(_Core.isReady()){
      this._promptStart();
    } else {
      this.log(_chalk.red('  No base files found!'));
      this._promptAction();
    }

  }

}

module.exports = _generator.Base.extend(baseExtension);